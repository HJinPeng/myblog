<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/2.jpg?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/2.jpg?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/2.jpg?v=5.1.4">


  <link rel="mask-icon" href="/images/2.jpg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="HJinPeng">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="HJinPeng">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="HJinPeng">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/3/">





  <title>HJinPeng</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">HJinPeng</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            About
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/08/js--防抖节流/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="HJP">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HJinPeng">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/08/js--防抖节流/" itemprop="url">js--防抖节流</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-12-08T00:00:00+08:00">
                2019-12-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavaScript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1-防抖debounce"><a href="#1-防抖debounce" class="headerlink" title="1. 防抖debounce"></a>1. 防抖debounce</h4><p>在事件被触发n秒后执行回调函数，如果在这n秒内又被触发，则重新计时。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">fn,delay</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">args</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> that = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">let</span> _args = args;</span><br><span class="line">        clearTimeout(fn.id);</span><br><span class="line">        fn.id = setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            fn.apply(that,_args)</span><br><span class="line">        &#125;,delay)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ajax</span>(<span class="params">content</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(content);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> inputb = <span class="built_in">document</span>.getElementById(<span class="string">'debounce'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> debounceAjax = debounce(ajax, <span class="number">500</span>)</span><br><span class="line"></span><br><span class="line">inputb.addEventListener(<span class="string">'keyup'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">    debounceAjax(e.target.value)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<h4 id="2-节流"><a href="#2-节流" class="headerlink" title="2. 节流"></a>2. 节流</h4><p>规定在一段时间内只能触发一次函数。如果这个单位时间内多次触发，只有一次生效。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">fn,delay</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> last,deferTimer;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">args</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> that = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">let</span> _args = args;</span><br><span class="line">        <span class="keyword">let</span> now = +<span class="keyword">new</span> <span class="built_in">Date</span>(); <span class="comment">// 1582428763953</span></span><br><span class="line">        <span class="keyword">if</span>(last &amp;&amp; last + delay &gt; now) &#123;</span><br><span class="line">            clearTimeout(deferTimer);</span><br><span class="line">            deferTimer = setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                last = now;</span><br><span class="line">                fun.apply(that,_args)</span><br><span class="line">            &#125;,delay)</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            last = now;</span><br><span class="line">            fun.apply(that,_args);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/04/js--跨域/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="HJP">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HJinPeng">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/04/js--跨域/" itemprop="url">js--跨域</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-12-04T00:00:00+08:00">
                2019-12-04
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavaScript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1-jsonp"><a href="#1-jsonp" class="headerlink" title="1. jsonp"></a>1. jsonp</h4><h5 id="1-1-原生实现"><a href="#1-1-原生实现" class="headerlink" title="1.1 原生实现"></a>1.1 原生实现</h5><p>通过动态创建script标签，请求一个带参网址实现跨域<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span><br><span class="line">script.type = <span class="string">'text/javascript'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 传参一个回调函数名给后端，方便后端返回时执行这个在前端定义的回调函数</span></span><br><span class="line">script.src = <span class="string">'http://www.domain2.com:8080/login?user=admin&amp;callback=handleCallback'</span>;</span><br><span class="line"><span class="built_in">document</span>.head.appendChild(script);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 回调执行函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleCallback</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">    alert(<span class="built_in">JSON</span>.stringify(res));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="1-2-jq"><a href="#1-2-jq" class="headerlink" title="1.2 jq"></a>1.2 jq</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">    url: <span class="string">'http://www.domain2.com:8080/login'</span>,</span><br><span class="line">    type: <span class="string">'get'</span>,</span><br><span class="line">    dataType: <span class="string">'jsonp'</span>,  <span class="comment">// 请求方式为jsonp</span></span><br><span class="line">    jsonpCallback: <span class="string">"handleCallback"</span>,    <span class="comment">// 自定义回调函数名</span></span><br><span class="line">    data: &#123;&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h5 id="1-3-vue"><a href="#1-3-vue" class="headerlink" title="1.3 vue"></a>1.3 vue</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$http.jsonp(<span class="string">'http://www.domain2.com:8080/login'</span>, &#123;</span><br><span class="line">    params: &#123;&#125;,</span><br><span class="line">    jsonp: <span class="string">'handleCallback'</span></span><br><span class="line">&#125;).then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res); </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h5 id="后端配合"><a href="#后端配合" class="headerlink" title="后端配合"></a>后端配合</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> querystring = <span class="built_in">require</span>(<span class="string">'querystring'</span>);</span><br><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">var</span> server = http.createServer();</span><br><span class="line"></span><br><span class="line">server.on(<span class="string">'request'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> params = qs.parse(req.url.split(<span class="string">'?'</span>)[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">var</span> fn = params.callback;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// jsonp返回设置</span></span><br><span class="line">    res.writeHead(<span class="number">200</span>, &#123; <span class="string">'Content-Type'</span>: <span class="string">'text/javascript'</span> &#125;);</span><br><span class="line">    res.write(fn + <span class="string">'('</span> + <span class="built_in">JSON</span>.stringify(params) + <span class="string">')'</span>);</span><br><span class="line"></span><br><span class="line">    res.end();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(<span class="string">'8080'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'Server is running at port 8080...'</span>);</span><br></pre></td></tr></table></figure>
<h4 id="2-document-domain-iframe"><a href="#2-document-domain-iframe" class="headerlink" title="2. document.domain + iframe"></a>2. document.domain + iframe</h4><p>实现原理，两个页面都通过js强制设置document.domain为基础主域，就实现了同域。<br>1.）父窗口：(<a href="http://www.domain.com/a.html" target="_blank" rel="noopener">http://www.domain.com/a.html</a>)<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">id</span>=<span class="string">"iframe"</span> <span class="attr">src</span>=<span class="string">"http://child.domain.com/b.html"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="built_in">document</span>.domain = <span class="string">'domain.com'</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> user = <span class="string">'admin'</span>;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>2.）子窗口：(<a href="http://child.domain.com/b.html" target="_blank" rel="noopener">http://child.domain.com/b.html</a>)<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="built_in">document</span>.domain = <span class="string">'domain.com'</span>;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 获取父窗口中变量</span></span></span><br><span class="line"><span class="javascript">    alert(<span class="string">'get js data from parent ---&gt; '</span> + <span class="built_in">window</span>.parent.user);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="3-location-hash-iframe跨域"><a href="#3-location-hash-iframe跨域" class="headerlink" title="3. location.hash + iframe跨域"></a>3. location.hash + iframe跨域</h4><h4 id="4-window-name-iframe跨域"><a href="#4-window-name-iframe跨域" class="headerlink" title="4. window.name + iframe跨域"></a>4. window.name + iframe跨域</h4><h4 id="5-cors"><a href="#5-cors" class="headerlink" title="5. cors"></a>5. cors</h4><h4 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h4><p><a href="https://segmentfault.com/a/1190000011145364" target="_blank" rel="noopener">https://segmentfault.com/a/1190000011145364</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/28/js--训练题3/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="HJP">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HJinPeng">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/28/js--训练题3/" itemprop="url">js--训练题3</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-28T00:00:00+08:00">
                2019-11-28
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavaScript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="1-以下代码执行时不会在控制台输出错误信息的是"><a href="#1-以下代码执行时不会在控制台输出错误信息的是" class="headerlink" title="1. 以下代码执行时不会在控制台输出错误信息的是"></a>1. 以下代码执行时不会在控制台输出错误信息的是</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">A.选项 </span><br><span class="line"><span class="keyword">let</span> a = <span class="built_in">decodeURIComponent</span>(<span class="string">'%'</span>);</span><br><span class="line"><span class="comment">// 报错。decodeURIComponent（）里面的参数：必需。一个字符串，含有编码 URI 组件或其他要解码的文本。</span></span><br><span class="line"></span><br><span class="line">B.选项</span><br><span class="line"><span class="keyword">var</span> a;</span><br><span class="line">a();</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(a);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 不报错。函数提升大于变量提升，声明变量但没赋值则仍未之前的值。</span></span><br><span class="line"><span class="comment">//变成</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(a);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a ;</span><br><span class="line">a();</span><br><span class="line"><span class="comment">// 函数提升，声明变量但没赋值，则a还是原来的函数。故输出function a()&#123;console.log(a)&#125;</span></span><br><span class="line"></span><br><span class="line">C.选项</span><br><span class="line"><span class="built_in">Promise</span>.reject(<span class="number">123</span>).finally(<span class="function"><span class="params">a</span> =&gt;</span> &#123;</span><br><span class="line"><span class="built_in">console</span>.log(a);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 报错。.reject后不能再用.finally</span></span><br><span class="line"></span><br><span class="line">D.选项</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">let</span> a = <span class="number">2</span>;</span><br><span class="line"><span class="built_in">console</span>.log(a);</span><br><span class="line"><span class="comment">// 报错。let不能再次声明存在的变量</span></span><br></pre></td></tr></table></figure>
<h5 id="2-以下代码执行后，a-x-和-b-x-的结果分别是？"><a href="#2-以下代码执行后，a-x-和-b-x-的结果分别是？" class="headerlink" title="2. 以下代码执行后，a.x 和 b.x 的结果分别是？"></a>2. 以下代码执行后，a.x 和 b.x 的结果分别是？</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">A</span>(<span class="params">x</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.x = x;</span><br><span class="line">&#125;</span><br><span class="line">A.prototype.x = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">B</span>(<span class="params">x</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.x = x;</span><br><span class="line">&#125;</span><br><span class="line">B.prototype = <span class="keyword">new</span> A();</span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> A(<span class="number">2</span>), b = <span class="keyword">new</span> B(<span class="number">3</span>);</span><br><span class="line"><span class="keyword">delete</span> b.x;</span><br></pre></td></tr></table></figure>
<p>结果： 2,undefined<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b的实例x=<span class="number">3</span>，<span class="keyword">delete</span>了b实例的<span class="number">3</span>，则找到b的原型，也就是a的实例，a的实例有x，但x是<span class="literal">undefined</span>。不再往上找。</span><br></pre></td></tr></table></figure></p>
<h5 id="3-以下哪些表达式的值为0？"><a href="#3-以下哪些表达式的值为0？" class="headerlink" title="3.以下哪些表达式的值为0？"></a>3.以下哪些表达式的值为0？</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">A选项： </span><br><span class="line">(<span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;).length; <span class="comment">//获取方法形参个数，形参为0  </span></span><br><span class="line">B选项：</span><br><span class="line"><span class="number">1</span> &amp; <span class="number">2</span>  <span class="comment">//1=0001 2=0010  按位与运算，同为1才为1，否则返回0</span></span><br><span class="line">C选项：</span><br><span class="line">+[]   <span class="comment">//  隐式类型转换，因为[]是对象.将对象转换成原始值，必然会调用toPrimitive()内部函数.所以toPrimitive-&gt;valueOf-&gt;toString为""，结果就是+""===0</span></span><br><span class="line">D选项：</span><br><span class="line">[<span class="number">1</span>,<span class="number">2</span>,<span class="number">-3</span>].reduce(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a - b, <span class="number">0</span>)  <span class="comment">//传入初始值0-&gt;0-(1)-&gt;(-1)-2-&gt;(-3)-(-3)-&gt;0</span></span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/27/js--训练题2/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="HJP">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HJinPeng">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/27/js--训练题2/" itemprop="url">js--训练题2</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-27T00:00:00+08:00">
                2019-11-27
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavaScript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1-输出结果是："><a href="#1-输出结果是：" class="headerlink" title="1. 输出结果是："></a>1. 输出结果是：</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> a = &#123;&#125;;</span><br><span class="line"><span class="keyword">const</span> b = &#123; <span class="attr">key</span> : <span class="string">"b"</span>&#125;;</span><br><span class="line"><span class="keyword">const</span> c = &#123; <span class="attr">key</span> : <span class="string">"c"</span>&#125;;</span><br><span class="line">a[b] = <span class="number">123</span>;</span><br><span class="line">a[c] = <span class="number">456</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a[b]);</span><br></pre></td></tr></table></figure>
<p><strong>结果：456</strong><br><strong>解析：</strong><br>因为a是对象，对象的key，都会使用toString()方法转为字符串，而b.toString()和c.toString()都是object Object。即变成a[object Object]；故a[b]=a[c]=a[object Object] = 456</p>
<h4 id="2-【不定项选择题】以下哪些方法会返回一个数组？"><a href="#2-【不定项选择题】以下哪些方法会返回一个数组？" class="headerlink" title="2. 【不定项选择题】以下哪些方法会返回一个数组？"></a>2. 【不定项选择题】以下哪些方法会返回一个数组？</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">A. Object.keys()</span><br><span class="line">B. String.prototype.split()</span><br><span class="line">C. Array.prototype.join()</span><br><span class="line">D. Promise.all()</span><br></pre></td></tr></table></figure>
<p><strong>答案：AB</strong><br><strong>解析：</strong><br>D的Promise.all返回的是一个promise实例，回调中的参数才是数组。</p>
<h4 id="3-要在10s后调用checkState，下列哪个是正确的。"><a href="#3-要在10s后调用checkState，下列哪个是正确的。" class="headerlink" title="3. 要在10s后调用checkState，下列哪个是正确的。"></a>3. 要在10s后调用checkState，下列哪个是正确的。</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">A. window.setTimeout(checkState,10);</span><br><span class="line">A. window.setTimeout(checkState,10000);</span><br><span class="line">A. window.setTimeout(checkState(),10);</span><br><span class="line">A. window.setTimeout(checkState(),10000);</span><br></pre></td></tr></table></figure>
<p><strong>答案：B</strong><br><strong>解析：</strong> checkState加了圆括号相当于函数表达式，会立即执行，执行结果作为返回值传递给setTimeout。<br><code>setTimeout(函数名,延迟事件)</code></p>
<h4 id="4-下面有关javascript系统方法的描述，错误的是？"><a href="#4-下面有关javascript系统方法的描述，错误的是？" class="headerlink" title="4. 下面有关javascript系统方法的描述，错误的是？"></a>4. 下面有关javascript系统方法的描述，错误的是？</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">A. parseFloat方法：该方法将一个字符串转换成对应的小数</span><br><span class="line">B. isNaN方法：该方法用于检测参数是否为数值型，如果是，返回true，否则，返回false。</span><br><span class="line">C. escape方法： 该方法返回对一个字符串编码后的结果字符串</span><br><span class="line">D. eval方法：该方法将某个参数字符串作为一个JavaScript执行</span><br></pre></td></tr></table></figure>
<p><strong>答案：B</strong><br><strong>解析：</strong> NaN，即非数值。所以isNaN在非数值的时候返回true，在数值时返回false。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">isNaN</span>(<span class="literal">NaN</span>); <span class="comment">// true----------&gt;Number(NaN)--&gt; NaN</span></span><br><span class="line"><span class="built_in">isNaN</span>(<span class="string">"abc"</span>) <span class="comment">// true----------&gt;Number("abc")--&gt; NaN</span></span><br><span class="line"><span class="built_in">isNaN</span>(<span class="string">"123"</span>) <span class="comment">// false---------&gt;Number("123")--&gt; 123</span></span><br><span class="line"><span class="built_in">isNaN</span>(<span class="literal">true</span>) <span class="comment">// false-----------&gt;Number(true)--&gt;1</span></span><br><span class="line"><span class="built_in">isNaN</span>(<span class="literal">false</span>) <span class="comment">// false----------&gt;Number(false)--&gt;0</span></span><br></pre></td></tr></table></figure></p>
<p>isNaN()函数用于检查其参数是否是非数字值，如果参数值为 NaN 或字符串、对象、undefined等非数字值则返回 true, 否则返回 false。<br>escape：返回字符的编码</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/25/js--训练题1/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="HJP">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HJinPeng">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/25/js--训练题1/" itemprop="url">js--训练题1</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-25T00:00:00+08:00">
                2019-11-25
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavaScript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="1-以下代码的执行打印结果是："><a href="#1-以下代码的执行打印结果是：" class="headerlink" title="1. 以下代码的执行打印结果是："></a>1. 以下代码的执行打印结果是：</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [];</span><br><span class="line">arr[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">arr[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">arr.foo = <span class="string">'c'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(arr.length);</span><br><span class="line"></span><br><span class="line">A. 报错</span><br><span class="line">B. <span class="number">3</span></span><br><span class="line">C. <span class="number">2</span></span><br><span class="line">D. undefined</span><br></pre></td></tr></table></figure>
<p><em>我的错误答案：B</em><br><strong>正确答案：A</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">解析： 数组也是一个对象。当使用arr[0],arr[1]时，</span><br><span class="line">使用了数组的方法往数组中添加了两个成员，</span><br><span class="line">而arr.foo是给数组这个对象添加了另一个属性foo，</span><br><span class="line">即foo属性和length属性同级。</span><br></pre></td></tr></table></figure></p>
<h5 id="2-浏览器对象BOM对象：-history-location-screen-navigator"><a href="#2-浏览器对象BOM对象：-history-location-screen-navigator" class="headerlink" title="2. 浏览器对象BOM对象： history location screen navigator"></a>2. 浏览器对象BOM对象： <code>history</code> <code>location</code> <code>screen</code> <code>navigator</code></h5><h5 id="3-写出下面代码运行的结果"><a href="#3-写出下面代码运行的结果" class="headerlink" title="3. 写出下面代码运行的结果"></a>3. 写出下面代码运行的结果</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a,b;</span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    alert(a);</span><br><span class="line">    alert(b);</span><br><span class="line">    <span class="keyword">var</span> a=b=<span class="number">3</span>;</span><br><span class="line">    alert(a); </span><br><span class="line">    alert(b); </span><br><span class="line">&#125;)();</span><br><span class="line">alert(a);</span><br><span class="line">alert(b);</span><br><span class="line"></span><br><span class="line">A. undefined,<span class="literal">undefined</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="literal">undefined</span>,<span class="number">3</span></span><br><span class="line">B. undefined,<span class="literal">undefined</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="literal">undefined</span>,<span class="literal">undefined</span></span><br><span class="line">C. <span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="literal">undefined</span>,<span class="literal">undefined</span></span><br><span class="line">D. undefined,<span class="literal">undefined</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">0</span></span><br></pre></td></tr></table></figure>
<p><em>我的错误答案：B</em><br><strong>正确答案：A</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">解析：var a=b=3 等价于 var a =3; b=3; 所以这里的b是全局变量</span><br></pre></td></tr></table></figure></p>
<h5 id="4-写出下面代码运行的结果"><a href="#4-写出下面代码运行的结果" class="headerlink" title="4. 写出下面代码运行的结果"></a>4. 写出下面代码运行的结果</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">i</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (i &lt; <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'begin:'</span> + i);</span><br><span class="line">  foo(i - <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'end:'</span> + i);</span><br><span class="line">&#125;</span><br><span class="line">foo(<span class="number">2</span>);</span><br></pre></td></tr></table></figure>
<p><strong>结果：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">begin:2</span><br><span class="line">begin:1</span><br><span class="line">begin:0</span><br><span class="line">end:0</span><br><span class="line">end:1</span><br><span class="line">end:2</span><br></pre></td></tr></table></figure></p>
<h5 id="5-写出下面代码运行的结果"><a href="#5-写出下面代码运行的结果" class="headerlink" title="5. 写出下面代码运行的结果"></a>5. 写出下面代码运行的结果</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> b = <span class="number">10</span>;</span><br><span class="line">(<span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    b = <span class="number">20</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(b);</span><br><span class="line">&#125;)();</span><br><span class="line"><span class="built_in">console</span>.log(b);</span><br></pre></td></tr></table></figure>
<p><strong>结果：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ƒ b()&#123;</span><br><span class="line">    b = 20;</span><br><span class="line">    console.log(b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">10</span><br></pre></td></tr></table></figure></p>
<h5 id="6-写出下面代码运行的结果"><a href="#6-写出下面代码运行的结果" class="headerlink" title="6. 写出下面代码运行的结果"></a>6. 写出下面代码运行的结果</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> b = <span class="number">10</span>;</span><br><span class="line">(<span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> b = <span class="number">20</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(b);</span><br><span class="line">&#125;)();</span><br><span class="line"><span class="built_in">console</span>.log(b);</span><br></pre></td></tr></table></figure>
<p><strong>结果：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">20</span><br><span class="line">10</span><br></pre></td></tr></table></figure></p>
<h5 id="7-现有一组人员年龄的数据，要求将这些人员的年龄按照从小到大的顺序进行排列起来，要怎样来实现（-）"><a href="#7-现有一组人员年龄的数据，要求将这些人员的年龄按照从小到大的顺序进行排列起来，要怎样来实现（-）" class="headerlink" title="7. 现有一组人员年龄的数据，要求将这些人员的年龄按照从小到大的顺序进行排列起来，要怎样来实现（      ）"></a>7. 现有一组人员年龄的数据，要求将这些人员的年龄按照从小到大的顺序进行排列起来，要怎样来实现（      ）</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">numberSort</span>(<span class="params">a,b</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a - b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr=<span class="keyword">new</span> <span class="built_in">Array</span>(<span class="string">"23"</span>,<span class="string">"6"</span>,<span class="string">"12"</span>,<span class="string">"35"</span>,<span class="string">"76"</span>);</span><br><span class="line"><span class="built_in">document</span>.write(arr.sort(numberSort));</span><br></pre></td></tr></table></figure>
<p><strong>解析：</strong><br>升序排序 return  a - b； 降序排序 return b - a。</p>
<h5 id="8-正则"><a href="#8-正则" class="headerlink" title="8. 正则"></a>8. 正则</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var str1=new RegExp(&quot;e&quot;);</span><br><span class="line">document.write(str1.exec(&quot;hello&quot;));</span><br><span class="line">以上代码输出结果为（      ）</span><br><span class="line">A. e</span><br><span class="line">B. null</span><br><span class="line">C. 1</span><br><span class="line">D. 其他几项都不对</span><br></pre></td></tr></table></figure>
<p>选择：A<br><strong>解析：</strong><br>如果 exec() 找到了匹配的文本，则返回一个结果数组。否则，返回 null。可以通过反复调用 exec() 方法来遍历字符串中的所有匹配文本。当 exec() 再也找不到匹配的文本时，它将返回 null</p>
<h5 id="9-下列代码输出结果正确的是-（）"><a href="#9-下列代码输出结果正确的是-（）" class="headerlink" title="9. 下列代码输出结果正确的是:（）"></a>9. 下列代码输出结果正确的是:（）</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var val = 12;</span><br><span class="line">function fun1()&#123;</span><br><span class="line">    console. log(val);</span><br><span class="line">    var val = 20;</span><br><span class="line">    console.log(val);</span><br><span class="line">&#125;</span><br><span class="line">fun1();</span><br></pre></td></tr></table></figure>
<p><strong>答案：undefined  20</strong><br><strong>解析：</strong><br>js里有域的概念，函数外边的是全局值，在fun1函数里是局部域，可以读取外部变量，但是这个局部域里又重新定义，就不会再读取外部，覆盖</p>
<h5 id="10-在一个块元素中，存在了很多的行元素，现在要求，将这些行元素中，只要有显示“叮咚”的行元素全部删除，怎么来做（-）"><a href="#10-在一个块元素中，存在了很多的行元素，现在要求，将这些行元素中，只要有显示“叮咚”的行元素全部删除，怎么来做（-）" class="headerlink" title="10. 在一个块元素中，存在了很多的行元素，现在要求，将这些行元素中，只要有显示“叮咚”的行元素全部删除，怎么来做（      ）"></a>10. 在一个块元素中，存在了很多的行元素，现在要求，将这些行元素中，只要有显示“叮咚”的行元素全部删除，怎么来做（      ）</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">A. $(&quot;span&quot;).detach(&quot;叮咚&quot;);</span><br><span class="line">B. $(p&quot;).detach(&quot;叮咚&quot;);</span><br><span class="line">C. $(&quot;div&quot;).detach(&quot;叮咚&quot;);</span><br><span class="line">D. $(&quot;em&quot;).detach(&quot;叮咚&quot;);</span><br></pre></td></tr></table></figure>
<p><strong>答案：A D</strong><br><strong>解析：</strong> detach() 方法移除被选元素，包括所有文本和子节点。<br>这个方法会保留 jQuery 对象中的匹配的元素，因而可以在将来再使用这些匹配的元素。<br>detach() 会保留所有绑定的事件、附加的数据，这一点与 remove() 不同。</p>
<h5 id="11-页面有一个按钮button-id为-button1，通过原生的js如何禁用？-IE-考虑IE-8-0以上版本"><a href="#11-页面有一个按钮button-id为-button1，通过原生的js如何禁用？-IE-考虑IE-8-0以上版本" class="headerlink" title="11. 页面有一个按钮button id为 button1，通过原生的js如何禁用？(IE 考虑IE 8.0以上版本)"></a>11. 页面有一个按钮button id为 button1，通过原生的js如何禁用？(IE 考虑IE 8.0以上版本)</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">A. document.getElementById(&quot;button1&quot;).readolny= true;</span><br><span class="line">B. document.getElementById(&quot;button1&quot;).setAttribute(“readolny”,”true”);</span><br><span class="line">C. document.getElementById(&quot;button1&quot;).disabled = true;</span><br><span class="line">D. document.getElementById(&quot;button1&quot;).setAttribute(“disabled”,”true”);</span><br></pre></td></tr></table></figure>
<p><strong>答案：C,D</strong><br><strong>解析：</strong> 直接设置该属性：element.disabled = false;<br>使用setAttribute将文本框的disabled属性设置为true时，它也会更改可编辑属性。尝试再次设置可编辑属性true，但它没有工作。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">enable</span>(<span class="params">id</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> eleman = <span class="built_in">document</span>.getElementById(id);</span><br><span class="line">    eleman.setAttribute(<span class="string">"disabled"</span>, <span class="literal">false</span>);</span><br><span class="line">    eleman.setAttribute(<span class="string">"disabled"</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这里真正的问题似乎在于您尝试通过setAttribute()设置禁用为false，而不会执行您期望的操作。如果禁用属性被设置，与其值无关(因此，disabled =“true”，disabled =“disabled”和disabled =“false”都会执行相同的操作：该元素被禁用)。您应该删除完整的属性：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">element.removeAttribute(<span class="string">"disabled"</span>);</span><br></pre></td></tr></table></figure></p>
<h5 id="12-解释型语言的特性有什么？"><a href="#12-解释型语言的特性有什么？" class="headerlink" title="12. 解释型语言的特性有什么？"></a>12. 解释型语言的特性有什么？</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">A. 非独立</span><br><span class="line">B. 效率低</span><br><span class="line">C. 独立</span><br><span class="line">D. 效率高性</span><br></pre></td></tr></table></figure>
<p><strong>答案：A,B</strong><br><strong>解析：</strong><br>解释性语言的定义：<br>解释性语言的程序不需要编译，在运行程序的时候才翻译，每个语句都是执行的时候才翻译。这样解释性语言每执行一次就需要逐行翻译一次，效率比较低。<br>现代解释性语言通常把源程序编译成中间代码，然后用解释器把中间代码一条条翻译成目标机器代码，一条条执行。</p>
<p>编译性语言的定义：<br>编译性语言写的程序在被执行之前，需要一个专门的编译过程，把程序编译成为机器语言的文件，比如exe文件，以后要运行的话就不用重新翻译了，直接使用编译的结果就行了（exe文件），因为翻译只做了一次，运行时不需要翻译，所以编译型语言的程序执行效率高。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/26/HTML--cookie,session,webstorage/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="HJP">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HJinPeng">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/26/HTML--cookie,session,webstorage/" itemprop="url">HTML--cookie,session,webstorage</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-26T00:00:00+08:00">
                2019-10-26
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/HTML5/" itemprop="url" rel="index">
                    <span itemprop="name">HTML5</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1-cookie-session区别"><a href="#1-cookie-session区别" class="headerlink" title="1. cookie session区别"></a>1. cookie session区别</h4><h5 id="1-1-区别"><a href="#1-1-区别" class="headerlink" title="1.1 区别"></a>1.1 区别</h5><ul>
<li><p>1.存取方式不同</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cookie存放在浏览器中，且单个cookie保存的数据不能超过4k，很多浏览器限制一个站点最多保存20个cookie。</span><br><span class="line">而session的数据存放在服务器上，能存储任何类型的数据。</span><br></pre></td></tr></table></figure>
</li>
<li><p>2.安全性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cookie存放在客户端，别人可以利用cookie做一些不安全的操作。</span><br><span class="line">session存放在服务端，客户端是不可见的，相对安全。</span><br></pre></td></tr></table></figure>
</li>
<li><p>3.服务器压力不同</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">session存放在服务端，每个用户都会产生一个session。故当并发访问用户十分多时，会浪费大量内存。</span><br><span class="line">而cookie在客户端，不占用服务器资源。对于Google、baidu，一般使用cookie。</span><br></pre></td></tr></table></figure>
</li>
<li><p>4.有效期不同</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cookie可以设置有效期，浏览器关闭后仍可存在</span><br><span class="line">而session在关闭浏览器就失效了</span><br></pre></td></tr></table></figure>
</li>
<li><p>5.浏览器支持的不同</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cookie需要浏览器支持，可以被禁用。如果客户端不支持cookie，则需要用session以及url地址重写（带sessionid）。  </span><br><span class="line">session只能在浏览器窗口及其子窗口内有效，如果两个窗口互不相关，则可使用两个session。</span><br></pre></td></tr></table></figure>
</li>
<li><p>6.跨域支持上的不同</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Cookie支持跨域名访问</span><br><span class="line">而Session则不会支持跨域名访问。Session仅在他所在的域名内有效</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="1-2-cookie机制"><a href="#1-2-cookie机制" class="headerlink" title="1.2 cookie机制"></a>1.2 cookie机制</h5><p>Cookies是服务器在本地机器上存储的小段文本并<strong>随每一个请求发送至同一个服务器</strong>  </p>
<p>cookies正常是服务器在http的响应头中添加一些提示让浏览器按照提示生成的，也可以通过js生成cookie  </p>
<p>cookie的内容主要包括：名字，值，过期时间，路径和域  </p>
<p>由于采用服务器端保存状态（session）的方案也需要在客户端保存一个标识，也需要用cookie</p>
<h5 id="1-3-session机制"><a href="#1-3-session机制" class="headerlink" title="1.3 session机制"></a>1.3 session机制</h5><p>当程序需要为某个客户端的请求创建一个session时，服务器首先检查这个客户端的请求里是否已包含了一个session标识（称为session id），如果已包含则说明以前已经为此客户端创建过session，服务器就按照session id把这个session检索出来使用（检索不到，会新建一个），如果客户端请求不包含session id，则为此客户端创建一个session并且生成一个与此session相关联的session id，session id的值应该是一个既不会重复，又不容易被找到规律以仿造的字符串，这个session id将被在本次响应中返回给客户端保存。</p>
<p>保存这个session id的方式可以采用cookie，这样在交互过程中浏览器可以自动的按照规则把这个标识发挥给服务器。</p>
<h4 id="2-cookie-sessionStorage-localStorage区别和使用"><a href="#2-cookie-sessionStorage-localStorage区别和使用" class="headerlink" title="2. cookie sessionStorage localStorage区别和使用"></a>2. cookie sessionStorage localStorage区别和使用</h4><h5 id="2-1-区别"><a href="#2-1-区别" class="headerlink" title="2.1 区别"></a>2.1 区别</h5><table><br><thead><br>    <tr><br>        <th>特性</th><br>        <th>cookie</th><br>        <th>localStorage</th><br>        <th>sessionStorage</th><br>    </tr><br></thead><br><tbody><br>    <tr><br>        <th>数据的生命周期</th><br>        <td>一般由服务器生成，可设置失效时间，如果在浏览器端生成的cookie,默认是关闭浏览器失效</td><br>        <td>除非被清除，否则永久保存</td><br>        <td>仅在当前会话下有效，关闭页面或浏览器后被清除</td><br>    </tr><br>    <tr><br>        <th>存放数据大小</th><br>        <td>4K左右</td><br>        <td colspan="2">一般为5MB</td><br>    </tr><br>    <tr><br>        <th>与服务器端通信</th><br>        <td>每次都会携带在http头中，如果使用cookie保存过多数据，会有性能问题</td><br>        <td colspan="2">仅在客户端（即浏览器）中保存，不参与和服务器的通信</td><br>    </tr><br>    <tr><br>        <th>易用性    </th><br>        <td>需要程序员自己封装，源生的Cookie接口不友好</td><br>        <td colspan="2">源生接口可以接受，亦可再次封装来对Object和Array有更好的支持</td><br>    </tr><br></tbody><br></table>

<h5 id="2-2-使用"><a href="#2-2-使用" class="headerlink" title="2.2 使用"></a>2.2 使用</h5><h6 id="2-2-1-cookie"><a href="#2-2-1-cookie" class="headerlink" title="2.2.1 cookie"></a>2.2.1 cookie</h6><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建cookie</span></span><br><span class="line"><span class="built_in">document</span>.cookie=<span class="string">"username=John Doe; expires=Thu, 18 Dec 2043 12:00:00 GMT; path=/"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//读取</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="built_in">document</span>.cookie;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改,旧的 cookie 将被覆盖</span></span><br><span class="line"><span class="built_in">document</span>.cookie=<span class="string">"username=John Smith; expires=Thu, 18 Dec 2043 12:00:00 GMT; path=/"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除只需要设置 expires 参数为以前的时间即可</span></span><br><span class="line"><span class="built_in">document</span>.cookie = <span class="string">"username=; expires=Thu, 01 Jan 1970 00:00:00 GMT"</span>;</span><br></pre></td></tr></table></figure>
<h6 id="2-2-2-localStorage"><a href="#2-2-2-localStorage" class="headerlink" title="2.2.2 localStorage"></a>2.2.2 localStorage</h6><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 把一个用户名(lilei)存储到 name 的键上</span></span><br><span class="line">localStorage.setItem(<span class="string">'name'</span>, <span class="string">'lilei'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 把一个用户存储到user的键上,需要注意的是，key和value值必须是字符串形式的，如果不是字符串，会调用它们相应的toString() 方法来转换成字符串再存储。当我们要存储对象是，应先转换成我们可识别的字符串格式（比如JSON格式）再进行存储。</span></span><br><span class="line">localStorage.setItem(<span class="string">'user'</span>, <span class="built_in">JSON</span>.stringify(id:<span class="number">1</span>, <span class="attr">name</span>:<span class="string">'lilei'</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取存储到 name 的键上的值</span></span><br><span class="line"><span class="keyword">var</span> name = localStorage.getItem(<span class="string">'name'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取存储到user的键上的值</span></span><br><span class="line"><span class="keyword">var</span> user = <span class="built_in">JSON</span>.parse(localStorage.getItem(<span class="string">'user'</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除存储到 name 的键上的值</span></span><br><span class="line">localStorage.removeItem(<span class="string">'name'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 清除 localStorage</span></span><br><span class="line">localStorage.clear();</span><br><span class="line"><span class="keyword">var</span> len = localStorage.length; <span class="comment">// 0</span></span><br></pre></td></tr></table></figure>
<p><strong>Web Storage 事件</strong><br>storage 事件当存储的数据发生变化时，会触发 storage 事件。但要注意的是它不同于click类的事件会事件捕获和冒泡，storage 事件更像是一个通知，不可取消。<strong>触发这个事件会调用同域下其他窗口的storage事件，不过触发storage的窗口（即当前窗口）不触发这个事件</strong>。storage 的 event 对象的常用属性如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">oldValue：更新前的值。如果该键为新增加，则这个属性为null。</span><br><span class="line">newValue：更新后的值。如果该键被删除，则这个属性为null。</span><br><span class="line">url：原始触发storage事件的那个网页的网址。</span><br><span class="line">key：存储store的key名</span><br></pre></td></tr></table></figure></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">storageChanged</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">arguments</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'storage'</span>, storageChanged, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure>
<p>基于 storage 事件特点，Web Storage 还可以用于同域不同窗口间的通信。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/25/HTML5--websocket/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="HJP">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HJinPeng">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/25/HTML5--websocket/" itemprop="url">HTML5--websocket</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-25T00:00:00+08:00">
                2019-10-25
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/HTML5/" itemprop="url" rel="index">
                    <span itemprop="name">HTML5</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="一、WebSocket的实现和应用"><a href="#一、WebSocket的实现和应用" class="headerlink" title="一、WebSocket的实现和应用"></a>一、WebSocket的实现和应用</h3><h4 id="0、前提"><a href="#0、前提" class="headerlink" title="0、前提"></a>0、前提</h4><p>HTTP协议只能由客户端向服务器端发起请求。如果要知道服务器端是否有持续变化，只能使用轮询 ++<em>(每个一段时间发送一个询问，了解服务器端有没有新消息)</em>++  </p>
<h4 id="1、-什么是WebSocket"><a href="#1、-什么是WebSocket" class="headerlink" title="1、 什么是WebSocket"></a>1、 什么是WebSocket</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">WebSocket是HTML5开始提供的一种浏览器与服务器进行全双工通讯的网络技术，属于应用层协议。它基于TCP传输协议，并复用HTTP的握手通道。 </span><br><span class="line">1. WebSocket可以在浏览器里使用</span><br><span class="line">2. 支持双向通信</span><br><span class="line">3. 使用很简单</span><br></pre></td></tr></table></figure>
<h4 id="2-WebSocket-协议的特点"><a href="#2-WebSocket-协议的特点" class="headerlink" title="2. WebSocket 协议的特点"></a>2. WebSocket 协议的特点</h4><p><strong>最大特点</strong> 就是，服务器可以主动向客户端推送信息，客户端也可以主动向服务器发送信息，是真正的双向平等对话，属于服务器推送技术的一种。  </p>
<p><strong>其他特点：</strong> </p>
<ol>
<li>建立在tcp协议上，服务器端实现比较容易。</li>
<li>与http有良好的兼容性，默认端口80,443，握手阶段采用http协议，不容易屏蔽。</li>
<li>数据格式轻量，性能开销小</li>
<li>可以发送文本，也可以发二进制数据</li>
<li>没有同源限制，客户端可以与任意服务器通信</li>
<li>协议标识符是ws(如果加密是wss) <code>ws://example.com:80/some/path</code></li>
</ol>
<h4 id="3-有什么优点？"><a href="#3-有什么优点？" class="headerlink" title="3. 有什么优点？"></a>3. 有什么优点？</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. 支持双向通信，实时性更强</span><br><span class="line">2. 更好的二进制支持</span><br><span class="line">3. 较少的控制开销。http协议每次通信都要携带完整的头部</span><br><span class="line">4. 支持扩展。用户可以扩展协议。</span><br></pre></td></tr></table></figure>
<h4 id="4-应用"><a href="#4-应用" class="headerlink" title="4. 应用"></a>4. 应用</h4><h5 id="4-1-阮一峰：客户端"><a href="#4-1-阮一峰：客户端" class="headerlink" title="4.1 阮一峰：客户端"></a>4.1 阮一峰：客户端</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> WebSocket(<span class="string">"wss://echo.websocket.org"</span>);</span><br><span class="line"></span><br><span class="line">ws.onopen = <span class="function"><span class="keyword">function</span>(<span class="params">evt</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"Connection open ..."</span>); </span><br><span class="line">  ws.send(<span class="string">"Hello WebSockets!"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ws.onmessage = <span class="function"><span class="keyword">function</span>(<span class="params">evt</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log( <span class="string">"Received Message: "</span> + evt.data);</span><br><span class="line">  ws.close();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ws.onclose = <span class="function"><span class="keyword">function</span>(<span class="params">evt</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"Connection closed."</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="4-2-服务端-客户端"><a href="#4-2-服务端-客户端" class="headerlink" title="4.2 服务端+客户端"></a>4.2 服务端+客户端</h5><p><strong>服务端</strong><br>代码如下，监听8080端口。当有新的连接请求到达时，打印日志，同时向客户端发送消息。当收到到来自客户端的消息时，同样打印日志。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> app = <span class="built_in">require</span>(<span class="string">'express'</span>)();</span><br><span class="line"><span class="keyword">var</span> server = <span class="built_in">require</span>(<span class="string">'http'</span>).Server(app);</span><br><span class="line"><span class="keyword">var</span> WebSocket = <span class="built_in">require</span>(<span class="string">'ws'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> wss = <span class="keyword">new</span> WebSocket.Server(&#123; <span class="attr">port</span>: <span class="number">8080</span> &#125;);</span><br><span class="line"></span><br><span class="line">wss.on(<span class="string">'connection'</span>, <span class="function"><span class="keyword">function</span> <span class="title">connection</span>(<span class="params">ws</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'server: receive connection.'</span>);</span><br><span class="line">    </span><br><span class="line">    ws.on(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span> <span class="title">incoming</span>(<span class="params">message</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'server: received: %s'</span>, message);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    ws.send(<span class="string">'world'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  res.sendfile(__dirname + <span class="string">'/index.html'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure></p>
<p><strong>客户端</strong><br>代码如下，向8080端口发起WebSocket连接。连接建立后，打印日志，同时向服务端发送消息。接收到来自服务端的消息后，同样打印日志。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> WebSocket(<span class="string">'ws://localhost:8080'</span>);</span><br><span class="line">ws.onopen = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'ws onopen'</span>);</span><br><span class="line">  ws.send(<span class="string">'from client: hello'</span>);</span><br><span class="line">&#125;;</span><br><span class="line">ws.onmessage = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'ws onmessage'</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'from server: '</span> + e.data);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p><strong>运行结果</strong><br>服务器端：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">server: receive connection.</span><br><span class="line">server: received:from client: hello</span><br></pre></td></tr></table></figure></p>
<p>客户端：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ws onopen</span><br><span class="line">ws onmessage from server: world</span><br></pre></td></tr></table></figure></p>
<h5 id="4-3-客户端的-API"><a href="#4-3-客户端的-API" class="headerlink" title="4.3. 客户端的 API"></a>4.3. 客户端的 API</h5><h6 id="4-3-1-WebSocket-构造函数"><a href="#4-3-1-WebSocket-构造函数" class="headerlink" title="4.3.1 WebSocket 构造函数"></a>4.3.1 WebSocket 构造函数</h6><p>WebSocket 对象作为一个构造函数，用于新建 WebSocket 实例。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> WebSocket(<span class="string">'ws://localhost:8080'</span>);</span><br></pre></td></tr></table></figure></p>
<p>执行上面语句之后，客户端就会与服务器进行连接。</p>
<h6 id="4-3-2-webSocket-readyState"><a href="#4-3-2-webSocket-readyState" class="headerlink" title="4.3.2 webSocket.readyState"></a>4.3.2 webSocket.readyState</h6><p><code>readyState</code>属性返回实例对象的当前状态，共有四种。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- CONNECTING：值为0，表示正在连接。</span><br><span class="line">- OPEN：值为1，表示连接成功，可以通信了。</span><br><span class="line">- CLOSING：值为2，表示连接正在关闭。</span><br><span class="line">- CLOSED：值为3，表示连接已经关闭，或者打开连接失败。</span><br></pre></td></tr></table></figure></p>
<h6 id="4-3-3-webSocket-onopen"><a href="#4-3-3-webSocket-onopen" class="headerlink" title="4.3.3 webSocket.onopen"></a>4.3.3 webSocket.onopen</h6><p>实例对象的<code>onopen</code>属性，用于指定连接成功后的回调函数<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ws.onopen = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  ws.send(<span class="string">'Hello Server!'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>如果要指定多个回调函数，可以使用<code>addEventListener</code>方法。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ws.addEventListener(<span class="string">'open'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">  ws.send(<span class="string">'Hello Server!'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h6 id="4-3-4-webSocket-onclose"><a href="#4-3-4-webSocket-onclose" class="headerlink" title="4.3.4 webSocket.onclose"></a>4.3.4 webSocket.onclose</h6><p>实例对象的<code>onclose</code>属性，用于指定连接关闭后的回调函数</p>
<h6 id="4-3-5-webSocket-onmessage"><a href="#4-3-5-webSocket-onmessage" class="headerlink" title="4.3.5 webSocket.onmessage"></a>4.3.5 webSocket.onmessage</h6><p>实例对象的<code>onmessage</code>属性，用于指定收到服务器数据后的回调函数。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 收到的是 blob 数据</span></span><br><span class="line">ws.binaryType = <span class="string">"blob"</span>;</span><br><span class="line">ws.onmessage = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(e.data.size);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 收到的是 ArrayBuffer 数据</span></span><br><span class="line">ws.binaryType = <span class="string">"arraybuffer"</span>;</span><br><span class="line">ws.onmessage = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(e.data.byteLength);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<h6 id="4-3-6-webSocket-send"><a href="#4-3-6-webSocket-send" class="headerlink" title="4.3.6 webSocket.send()"></a>4.3.6 webSocket.send()</h6><p>实例对象的<code>send()</code>方法用于向服务器发送数据。</p>
<p>发送文本的例子。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ws.send(<span class="string">'your message'</span>);</span><br></pre></td></tr></table></figure>
<p>发送 <code>Blob</code> 对象的例子。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> file = <span class="built_in">document</span></span><br><span class="line">  .querySelector(<span class="string">'input[type="file"]'</span>)</span><br><span class="line">  .files[<span class="number">0</span>];</span><br><span class="line">ws.send(file);</span><br></pre></td></tr></table></figure>
<p>发送 <code>ArrayBuffer</code> 对象的例子。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Sending canvas ImageData as ArrayBuffer</span></span><br><span class="line"><span class="keyword">var</span> img = canvas_context.getImageData(<span class="number">0</span>, <span class="number">0</span>, <span class="number">400</span>, <span class="number">320</span>);</span><br><span class="line"><span class="keyword">var</span> binary = <span class="keyword">new</span> <span class="built_in">Uint8Array</span>(img.data.length);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; img.data.length; i++) &#123;</span><br><span class="line">  binary[i] = img.data[i];</span><br><span class="line">&#125;</span><br><span class="line">ws.send(binary.buffer);</span><br></pre></td></tr></table></figure>
<h6 id="4-3-7-webSocket-bufferedAmount"><a href="#4-3-7-webSocket-bufferedAmount" class="headerlink" title="4.3.7 webSocket.bufferedAmount"></a>4.3.7 webSocket.bufferedAmount</h6><p>实例对象的<code>bufferedAmount</code>属性，表示还有多少字节的二进制数据没有发送出去。它可以用来判断发送是否结束。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> data = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">10000000</span>);</span><br><span class="line">socket.send(data);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (socket.bufferedAmount === <span class="number">0</span>) &#123;</span><br><span class="line">  <span class="comment">// 发送完毕</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="comment">// 发送还没结束</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h6 id="4-3-8-webSocket-onerror"><a href="#4-3-8-webSocket-onerror" class="headerlink" title="4.3.8 webSocket.onerror"></a>4.3.8 webSocket.onerror</h6><p>实例对象的<code>onerror</code>属性，用于指定报错时的回调函数。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">socket.onerror = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// handle error event</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">socket.addEventListener(<span class="string">"error"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// handle error event</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h4 id="5-如何建立连接"><a href="#5-如何建立连接" class="headerlink" title="5. 如何建立连接"></a>5. 如何建立连接</h4><h5 id="5-1-客户端：申请协议升级"><a href="#5-1-客户端：申请协议升级" class="headerlink" title="5.1 客户端：申请协议升级"></a>5.1 客户端：申请协议升级</h5><p>首先，客户端发起协议升级请求。可以看到，采用的是标准的HTTP报文格式，且只支持<code>GET</code>方法。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET / HTTP/1.1</span><br><span class="line">Host: localhost:8080</span><br><span class="line">Origin: http://127.0.0.1:3000</span><br><span class="line">Connection: Upgrade</span><br><span class="line">Upgrade: websocket</span><br><span class="line">Sec-WebSocket-Version: 13</span><br><span class="line">Sec-WebSocket-Key: w4v7O6xFTi36lq3RNcgctw==</span><br></pre></td></tr></table></figure></p>
<p>重点请求首部意义如下：  </p>
<ul>
<li><code>Connection: Upgrade</code>：表示要升级协议</li>
<li><code>Upgrade: websocket</code>：表示要升级到websocket协议。</li>
<li><code>Sec-WebSocket-Version: 13</code>：表示websocket的版本。如果服务端不支持该版本，需要返回一个Sec-WebSocket-Versionheader，里面包含服务端支持的版本号。</li>
<li><code>Sec-WebSocket-Key</code>：与后面服务端响应首部的Sec-WebSocket-Accept是配套的，提供基本的防护，比如恶意的连接，或者无意的连接。</li>
</ul>
<h5 id="5-2-服务端：响应协议升级"><a href="#5-2-服务端：响应协议升级" class="headerlink" title="5.2 服务端：响应协议升级"></a>5.2 服务端：响应协议升级</h5><p>服务端返回内容如下，状态代码<code>101</code>表示协议切换。到此完成协议升级，后续的数据交互都按照新的协议来。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 101 Switching Protocols</span><br><span class="line">Connection:Upgrade</span><br><span class="line">Upgrade: websocket</span><br><span class="line">Sec-WebSocket-Accept: Oy4NRAQ13jhfONC7bP8dTKb4PTU=</span><br></pre></td></tr></table></figure></p>
<h3 id="二、参考博文"><a href="#二、参考博文" class="headerlink" title="二、参考博文"></a>二、参考博文</h3><p><a href="https://www.ruanyifeng.com/blog/2017/05/websocket.html" target="_blank" rel="noopener">WebSocket 教程–阮一峰</a><br><a href="https://www.cnblogs.com/chyingp/p/websocket-deep-in.html" target="_blank" rel="noopener">WebSocket协议：5分钟从入门到精通</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/24/计网--http(1)/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="HJP">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HJinPeng">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/24/计网--http(1)/" itemprop="url">计网--http(1)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-24T00:00:00+08:00">
                2019-10-24
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/计网/" itemprop="url" rel="index">
                    <span itemprop="name">计网</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1-说一下http和https"><a href="#1-说一下http和https" class="headerlink" title="1. 说一下http和https"></a>1. 说一下http和https</h4><p>（1）什么是http和https？<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http: 超文本传输协议。是一个客户端和服务器端请求和响应的标准。  </span><br><span class="line">https: 是http+SSL。在http下加入了SSL层。建立一个安全的信息通道，确保网站的真实性。</span><br></pre></td></tr></table></figure></p>
<p>（2）http和https的区别？<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. http是超文本传输协议，传输的数据都是未加密的。</span><br><span class="line">而https是具有安全性的ssl加密传输协议。  </span><br><span class="line">2. http端口为80，https端口为443</span><br><span class="line">3. http的连接是无状态的，而httos是由http+ssl协议构建的可进行加密传输、身份验证的网络协议，比http安全。</span><br></pre></td></tr></table></figure></p>
<p>（3）https的工作原理？<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1. 客户使用https url访问服务器，则要求web 服务器建立ssl链接。</span><br><span class="line">2. web服务器接收到客户端的请求之后，会将网站的证书（证书中包含了公钥），返回或者说传输给客户端。</span><br><span class="line">3. 客户端和web服务器端开始协商SSL链接的安全等级，也就是加密等级。</span><br><span class="line">4. 客户端浏览器通过双方协商一致的安全等级，建立会话密钥，然后通过网站的公钥来加密会话密钥，并传送给网站。</span><br><span class="line">5. web服务器通过自己的私钥解密出会话密钥。</span><br><span class="line">6. web服务器通过会话密钥加密与客户端之间的通信。</span><br></pre></td></tr></table></figure></p>
<p>(4) https的优缺点？<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">优点：</span><br><span class="line">    1. 安全，不被窃取</span><br><span class="line">    2. 确保数据发到正确的客户端和服务器端</span><br><span class="line">缺点：</span><br><span class="line">    1. 耗时耗电</span><br><span class="line">    2. 缓存不如http高效</span><br><span class="line">    3. 要钱</span><br><span class="line">    4. SSL需要绑定ip，不能在同一个ip上绑定多个域名</span><br></pre></td></tr></table></figure></p>
<h4 id="2-HTTP版本和请求方法"><a href="#2-HTTP版本和请求方法" class="headerlink" title="2. HTTP版本和请求方法"></a>2. HTTP版本和请求方法</h4><h5 id="2-1-HTTP版本"><a href="#2-1-HTTP版本" class="headerlink" title="2.1 HTTP版本"></a>2.1 HTTP版本</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HTTP/0.9 : 只有GET一种请求方法</span><br><span class="line">HTTP/1.0 : 支持GET、POST、HEAD三种HTTP请求方法</span><br><span class="line">HTTP/1.1 : 新增了OPTIONS、PUT、DELETE、TRACE、CONNECT五种HTTP请求方法</span><br><span class="line">HTTP/2   : 支持请求与相应的多路重用来减少延迟，通过压缩HTTP头字段将协议开销降到最低，同时增加了对请求优先级和服务器端推送的支持</span><br></pre></td></tr></table></figure>
<h5 id="2-2-HTTP请求方法"><a href="#2-2-HTTP请求方法" class="headerlink" title="2.2 HTTP请求方法"></a>2.2 HTTP请求方法</h5><p><code>GET</code>：会显示请求的指定资源。一般<code>GET</code>方法应该只用于数据的读取。<code>GET</code>方法会返回响应主体，<code>GET</code>被认为是不安全的方法。  </p>
<p><code>HEAD</code>: 服务器在响应<code>HEAD</code>请求时不会回传资源的内容部分（响应主体），而是回传响应头。这个方法一般用来客户端查看服务器的性能。    </p>
<p><code>POST</code>: <code>POST</code>请求会向指定资源提交数据，请求服务器进行处理：表单提交，文件上传…请求数据会被包含在请求体中  </p>
<p><code>PUT</code>: 该方法客户端可以将指定资源的最新数据传送到服务器取代对应的资源内容。  </p>
<p><code>DELETE</code>: 请求服务器删除所请求的URI所标识对的资源。  </p>
<p><code>CONNECT</code>：能够将连接改为管道方式的代理服务器。通常用于SSL加密服务器和未加密的HTTP代理服务器的通信。  </p>
<p><code>OPTIONS</code>：<code>OPTIONS</code>请求和<code>HEAD</code>请求类似，一般也是用于查看服务器的性能。这个方法会请求服务器返回该资源所支持的所有HTTP请求方法，该方法会用<code>*</code>来代替资源名称，向服务器发送<code>OPTIONS</code>请求，可以测试服务器功能是否正常。JS的XMLHttpRequest对象进行CORS跨域资源共享时，就是使用OPTOINS方法发送嗅探请求，以判断是否对资源有访问权限。  </p>
<p><code>TRACE</code>： TRACE请求服务器回显其收到的请求信息，该方法主要用于HTTP请求的测试或诊断。  </p>
<p><code>PATCH</code>: PATCH请求与PUT请求类似，同样用于资源的更新。二者有以下两点不同：1.PATCH一般用于资源的部分更新，而PUT一般用于资源的整体更新。2.当资源不存在时，PATCH会创建一个新的资源，而PUT只会对已在资源进行更新。  </p>
<h5 id="2-3-POST请求"><a href="#2-3-POST请求" class="headerlink" title="2.3 POST请求"></a>2.3 POST请求</h5><p>服务端通常是根据请求头（headers）中的 Content-Type 字段来获知请求中的消息主体是用何种方式编码，再对主体进行解析。所以说到 POST 提交数据方案，包含了 Content-Type 和消息主体编码方式两部分。数据格式有：    </p>
<p><strong>1. application/x-www-form-urlencoded</strong><br>这应该是最常见的 POST 提交数据的方式了。浏览器的原生 <code>&lt;form&gt;</code> 表单，如果不设置 <code>enctype</code> 属性，那么最终就会以 <code>application/x-www-form-urlencoded</code> 方式提交数据。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST http://www.example.com HTTP/1.1</span><br><span class="line">Content-Type: application/x-www-form-urlencoded;charset=utf-8</span><br><span class="line"></span><br><span class="line">title=test&amp;sub%5B%5D=1&amp;sub%5B%5D=2&amp;sub%5B%5D=3</span><br></pre></td></tr></table></figure></p>
<p><strong>2. multipart/form-data</strong><br>这又是一个常见的 POST 数据提交的方式。我们使用表单上传文件时，必须让<code>&lt;form&gt;</code> 表单的 <code>enctype</code> 等于 <code>multipart/form-data</code>。  </p>
<p><strong>3. application/json</strong><br>现在越来越多的人把它作为请求头，用来告诉服务端消息主体是序列化后的 JSON 字符串<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST http://www.example.com HTTP/1.1 </span><br><span class="line">Content-Type: application/json;charset=utf-8</span><br><span class="line"></span><br><span class="line">&#123;&quot;title&quot;:&quot;test&quot;,&quot;sub&quot;:[1,2,3]&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>4. text/xml</strong><br>它是一种使用 HTTP 作为传输协议，XML 作为编码方式的远程调用规范。  </p>
<h4 id="3-WebSocket的实现和应用"><a href="#3-WebSocket的实现和应用" class="headerlink" title="3. WebSocket的实现和应用"></a>3. WebSocket的实现和应用</h4><p>见【3. WebSocket的实现和应用】</p>
<h4 id="4-影响HTTP-网络请求的因素"><a href="#4-影响HTTP-网络请求的因素" class="headerlink" title="4. 影响HTTP 网络请求的因素"></a>4. 影响HTTP 网络请求的因素</h4><p>影响一个 HTTP 网络请求的因素主要有两个：带宽和延迟。  </p>
<ul>
<li><p>带宽</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">现在不是问题</span><br></pre></td></tr></table></figure>
</li>
<li><p>延迟</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 浏览器阻塞（HOL blocking）：浏览器会因为一些原因阻塞请求。浏览器对于同一个域名，同时只能有 4 个连接（这个根据浏览器内核不同可能会有所差异），超过浏览器最大连接数限制，后续请求就会被阻塞。</span><br><span class="line">2. DNS 查询（DNS Lookup）：浏览器需要知道目标服务器的 IP 才能建立连接。将域名解析为 IP 的这个系统就是 DNS。这个通常可以利用DNS缓存结果来达到减少这个时间的目的。</span><br><span class="line">3. 建立连接（Initial connection）：HTTP 是基于 TCP 协议的，浏览器最快也要在第三次握手时才能捎带 HTTP 请求报文，达到真正的建立连接，但是这些连接无法复用会导致每次请求都经历三次握手和慢启动。三次握手在高延迟的场景下影响较明显，慢启动则对文件类大请求影响较大。</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="5-http2-0-优点"><a href="#5-http2-0-优点" class="headerlink" title="5. http2.0 优点"></a>5. http2.0 优点</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. 新的二进制格式</span><br><span class="line">2. 多路复用 : 一个request对应一个id，这样一个连接上可以有多个request，每个连接的request可以随机的混杂在一起，接收方可以根据request的 id将request再归属到各自不同的服务端请求里面。</span><br><span class="line">3. header压缩: HTTP1.x的header带有大量信息，而且每次都要重复发送，HTTP2.0使用encoder来减少需要传输的header大小，通讯双方各自cache一份header fields表，既避免了重复header的传输，又减小了需要传输的大小。  </span><br><span class="line">4. 服务端推送</span><br></pre></td></tr></table></figure>
<h4 id="6-GET和POST的区别"><a href="#6-GET和POST的区别" class="headerlink" title="6. GET和POST的区别"></a>6. GET和POST的区别</h4><ol>
<li><code>GET</code> 和 <code>POST</code> 方法没有实质区别，只是报文格式不同。 </li>
<li>没有传参的GET和POST请求只有请求报文第一行的前几个字符不同(GET和POST这几个字符不同)</li>
<li>传参的GET的参数在第一行的URL中，POST的参数在body中</li>
<li>POST方法和GET方法都不安全，因为是明文传输的，可以通过抓包获取参数。要安全使用https</li>
<li>GET长度限制可能是浏览器限制和服务器的限制。POST长度无限制</li>
<li>点击后退按钮，GET没问题，POST的数据会被重新提交。</li>
<li>GET能缓存，POST不可以</li>
<li>编码类型，GET使用application/x-www-form-urlencoded,POST可用多种</li>
<li>GET的参数可见，保存在历史记录，POST的不显示在URL中，不会保存到浏览器历史</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/24/计网--http(2)/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="HJP">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HJinPeng">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/24/计网--http(2)/" itemprop="url">计网--http(2)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-24T00:00:00+08:00">
                2019-10-24
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/计网/" itemprop="url" rel="index">
                    <span itemprop="name">计网</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1-http状态码"><a href="#1-http状态码" class="headerlink" title="1. http状态码"></a>1. http状态码</h4><table><br><tr><br>    <td style="width:60px">100</td><br>    <td style="width:100px">Continue</td><br>    <td>继续。客户端应继续其请求</td><br></tr><br><tr><br>    <td>101</td><br>    <td>Switching Protocols</td><br>    <td>切换协议。服务器根据客户端的请求切换协议。只能切换到更高级的协议，例如，切换到HTTP的新版本协议</td><br></tr><br><tr><br>    <td>200</td><br>    <td>OK</td><br>    <td>请求成功。一般用于GET与POST请求</td><br></tr><br><tr><br>    <td>205</td><br>    <td>Reset Content</td><br>    <td>重置内容。服务器处理成功，用户终端（例如：浏览器）应重置文档视图。可通过此返回码清除浏览器的表单域</td><br></tr><br><tr><br>    <td>301</td><br>    <td>Moved Permanently</td><br>    <td>永久移动。请求的资源已被永久的移动到新URI，返回信息会包括新的URI，浏览器会自动定向到新URI。今后任何新的请求都应使用新的URI代替</td><br></tr><br><tr><br>    <td>302</td><br>    <td>Found</td><br>    <td>临时移动。与301类似。但资源只是临时被移动。客户端应继续使用原有URI</td><br></tr><br><tr><br>    <td>304</td><br>    <td>Not Modified</td><br>    <td>未修改。所请求的资源未修改，服务器返回此状态码时，不会返回任何资源。客户端通常会缓存访问过的资源，通过提供一个头信息指出客户端希望只返回在指定日期之后修改的资源</td><br></tr><br><tr><br>    <td>305</td><br>    <td>Use Proxy</td><br>    <td>使用代理。所请求的资源必须通过代理访问</td><br></tr><br><tr><br>    <td>307</td><br>    <td>Temporary Redirect</td><br>    <td>临时重定向。与302类似。使用GET请求重定向</td><br></tr><br><tr><br>    <td>400</td><br>    <td>Bad Request</td><br>    <td>客户端请求的语法错误，服务器无法理解</td><br></tr><br><tr><br>    <td>401</td><br>    <td>Unauthorized</td><br>    <td>请求要求用户的身份认证</td><br></tr><br><tr><br>    <td>403</td><br>    <td>Forbidden</td><br>    <td>服务器理解请求客户端的请求，但是拒绝执行此请求</td><br></tr><br><tr><br>    <td>404</td><br>    <td>Not Found</td><br>    <td>服务器无法根据客户端的请求找到资源（网页）。通过此代码，网站设计人员可设置”您所请求的资源无法找到”的个性页面</td><br></tr><br><tr><br>    <td>407</td><br>    <td>Proxy Authentication Required</td><br>    <td>请求要求代理的身份认证，与401类似，但请求者应当使用代理进行授权</td><br></tr><br><tr><br>    <td>500</td><br>    <td>Internal Server Error</td><br>    <td>服务器内部错误，无法完成请求</td><br></tr><br></table>

<h4 id="2-http常用请求头"><a href="#2-http常用请求头" class="headerlink" title="2. http常用请求头"></a>2. http常用请求头</h4><table><br><thead><br>    <tr><br>        <th style="width:100px">请求头</th><br>        <th>说明</th><br>        <th>示例</th><br>    </tr><br></thead><br><tbody><br>    <tr><br>        <td>Accept</td><br>        <td>可接受的响应内容类型（Content-Types）。</td><br>        <td>Accept: text/plain</td><br>    </tr><br>    <tr><br>        <td>Accept-Charset</td><br>        <td>可接受的字符集</td><br>        <td>Accept-Charset: utf-8</td><br>    </tr><br>    <tr><br>        <td>Accept-Encoding</td><br>        <td>可接受的响应内容的编码方式。</td><br>        <td>Accept-Encoding: gzip, deflate</td><br>    </tr><br>    <tr><br>        <td>Cache-Control</td><br>        <td>用来指定当前的请求/回复中的，是否使用缓存机制。</td><br>        <td>Cache-Control: no-cache</td><br>    </tr><br>    <tr><br>        <td>Connection</td><br>        <td>客户端（浏览器）想要优先使用的连接类型</td><br>        <td>Connection: keep-alive<br>        Connection: Upgrade</td><br>    </tr><br>    <tr><br>        <td>Cookie</td><br>        <td>由之前服务器通过Set-Cookie 设置的一个HTTP协议Cookie</td><br>        <td>Cookie: $Version=1; Skin=new;</td><br>    </tr><br>    <tr><br>        <td>Content-Type</td><br>        <td>请求体的MIME类型 （用于POST和PUT请求中）</td><br>        <td>Content-Type: application/x-www-form-urlencoded</td><br>    </tr><br>    <tr><br>        <td>Host</td><br>        <td>表示服务器的域名以及服务器所监听的端口号。如果所请求的端口是对应的服务的标准端口（80），则端口号可以省略。</td><br>        <td>Host: <a href="http://www.itbilu.com:3000" target="_blank" rel="noopener">www.itbilu.com:3000</a></td><br>    </tr><br>    <tr><br>        <td>If-Modified-Since</td><br>        <td>允许在对应的资源未被修改的情况下返回304未修改</td><br>        <td>If-Modified-Since: Dec, 26 Dec 2015 17:30:00 GMT</td><br>    </tr><br>    <tr><br>        <td>If-None-Match</td><br>        <td>允许在对应的内容未被修改的情况下返回304未修改（ 304 Not Modified ），参考 超文本传输协议 的实体标记</td><br>        <td>If-None-Match: “9jd00cdj34pss9ejqiw39d82f20d0ikd”</td><br>    </tr><br>    <tr><br>        <td>If-Unmodified-Since</td><br>        <td>仅当该实体自某个特定时间以来未被修改的情况下，才发送回应。</td><br>        <td>If-Unmodified-Since: Dec, 26 Dec 2015 17:30:00 GMT</td><br>    </tr><br>    <tr><br>        <td>Origin</td><br>        <td>发起一个针对跨域资源共享的请求（该请求要求服务器在响应中加入一个Access-Control-Allow-Origin的消息头，表示访问控制所允许的来源）。</td><br>        <td>Origin: <a href="http://www.itbilu.com" target="_blank" rel="noopener">http://www.itbilu.com</a></td><br>    </tr><br>    <tr><br>        <td>Upgrade</td><br>        <td>要求服务器升级到一个高版本协议。</td><br>        <td>Upgrade: HTTP/2.0, SHTTP/1.3, IRC/6.9, RTA/x11</td><br>    </tr><br></tbody><br></table>

<h4 id="3-http常用响应头"><a href="#3-http常用响应头" class="headerlink" title="3. http常用响应头"></a>3. http常用响应头</h4><table><br><thead><br><tr><br>    <th style="width:100px">响应头</th><br>    <th>说明</th><br>    <th>示例</th><br></tr><br></thead><br><tbody><br><tr><br>    <td>Access-Control-Allow-Origin</td><br>    <td>指定哪些网站可以<b>跨域源资源共享</b></td><br>    <td>Access-Control-Allow-Origin: *</td><br></tr><br><tr><br>    <td>Allow</td><br>    <td>对于特定资源的有效动作;</td><br>    <td>Allow: GET, HEAD</td><br></tr><br><tr><br>    <td>Cache-Control</td><br>    <td>通知从服务器到客户端内的所有缓存机制，表示它们是否可以缓存这个对象及缓存有效时间。其单位为秒</td><br>    <td>Cache-Control: max-age=3600</td><br></tr><br><tr><br>    <td>Content-Encoding</td><br>    <td>响应资源所使用的编码类型</td><br>    <td>Content-Encoding: gzip</td><br></tr><br><tr><br>    <td>Content-Type</td><br>    <td>当前内容的MIME类型</td><br>    <td>Content-Type: text/html; charset=utf-8</td><br></tr><br><tr><br>    <td>ETag</td><br>    <td>对于某个资源的某个特定版本的一个标识符，通常是一个 消息散列</td><br>    <td>ETag: “737060cd8c284d8af7ad3082f209582d”</td><br></tr><br><tr><br>    <td>Expires</td><br>    <td>指定一个日期/时间，超过该时间则认为此回应已经过期</td><br>    <td>Expires: Thu, 01 Dec 1994 16:00:00 GMT</td><br></tr><br><tr><br>    <td>Last-Modified</td><br>    <td>所请求的对象的最后修改日期(按照 RFC 7231 中定义的“超文本传输协议日期”格式来表示)</td><br>    <td>Last-Modified: Dec, 26 Dec 2015 17:30:00 GMT</td><br></tr><br><tr><br>    <td>Location</td><br>    <td>用于在进行重定向，或在创建了某个新资源时使用。</td><br>    <td>Location: <a href="http://www.itbilu.com/nodejs" target="_blank" rel="noopener">http://www.itbilu.com/nodejs</a></td><br></tr><br><tr><br>    <td>Refresh</td><br>    <td>用于重定向，或者当一个新的资源被创建时。默认会在5秒后刷新重定向。</td><br>    <td>Refresh: 5; url=<a href="http://itbilu.com" target="_blank" rel="noopener">http://itbilu.com</a></td><br></tr><br><tr><br>    <td>Set-Cookie</td><br>    <td>设置HTTP cookie</td><br>    <td>Set-Cookie: UserID=itbilu; Max-Age=3600; Version=1</td><br></tr><br><tr><br>    <td>Status</td><br>    <td>通用网关接口的响应头字段，用来说明当前HTTP连接的响应状态。</td><br>    <td>Status: 200 OK</td><br></tr><br><tr><br>    <td>Upgrade</td><br>    <td>要求客户端升级到另一个高版本协议。</td><br>    <td>Upgrade: HTTP/2.0, SHTTP/1.3, IRC/6.9, RTA/x11</td><br></tr><br></tbody><br></table>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/24/计网--http(3)/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="HJP">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HJinPeng">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/24/计网--http(3)/" itemprop="url">计网--http(3)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-24T00:00:00+08:00">
                2019-10-24
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/计网/" itemprop="url" rel="index">
                    <span itemprop="name">计网</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1-强缓存、协商缓存"><a href="#1-强缓存、协商缓存" class="headerlink" title="1. 强缓存、协商缓存"></a>1. 强缓存、协商缓存</h4><h5 id="1-1-什么是缓存？"><a href="#1-1-什么是缓存？" class="headerlink" title="1.1 什么是缓存？"></a>1.1 什么是缓存？</h5><p>浏览器缓存(Brower Caching)是浏览器对之前请求过的文件进行缓存，以便下一次访问时重复使用，节省带宽，提高访问速度，降低服务器压力。  </p>
<p>http缓存机制主要在http响应头中设定，响应头中相关字段为 :<br><code>Expires</code>(指定一个日期/时间，超过该时间则认为此回应已经过期)、<br><code>Cache-Control</code>(通知从服务器到客户端内的所有缓存机制，表示它们是否可以缓存这个对象及缓存有效时间。其单位为秒)、<br><code>Last-Modified</code>(所请求的对象的最后修改日期)、<br><code>Etag</code>(对于某个资源的某个特定版本的一个标识符)。</p>
<h5 id="1-2-浏览器是如何判断是否使用缓存的"><a href="#1-2-浏览器是如何判断是否使用缓存的" class="headerlink" title="1.2 浏览器是如何判断是否使用缓存的?"></a>1.2 浏览器是如何判断是否使用缓存的?</h5><p>第一次请求：  </p>
<p><img src="https://user-gold-cdn.xitu.io/2019/5/6/16a8bbc2df77f4f6?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="image"></p>
<p>第二次请求相同网页：  </p>
<p><img src="https://user-gold-cdn.xitu.io/2019/5/6/16a8bbaefa56810f?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="image"></p>
<h5 id="1-3-缓存的类别"><a href="#1-3-缓存的类别" class="headerlink" title="1.3 缓存的类别"></a>1.3 缓存的类别</h5><h6 id="1-3-1-强缓存"><a href="#1-3-1-强缓存" class="headerlink" title="1.3.1 强缓存"></a>1.3.1 强缓存</h6><p>浏览器不会像服务器发送任何请求，直接从本地缓存中读取文件并返回Status Code: 200 OK<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Expires(响应头返回): 过期时间，如果设置了时间，则浏览器会在设置的时间内直接读取缓存，不再请求  </span><br><span class="line">Cache-Control(响应头返回)：当值设为max-age=300时，则代表在这个请求正确返回时间（浏览器也会记录下来）的5分钟内再次加载资源，就会命中强缓存。</span><br></pre></td></tr></table></figure></p>
<p>cache-control是http1.1的头字段，expires是http1.0的头字段,如果expires和cache-control同时存在，cache-control会覆盖expires，建议两个都写。</p>
<h6 id="1-3-2-协商缓存"><a href="#1-3-2-协商缓存" class="headerlink" title="1.3.2 协商缓存"></a>1.3.2 协商缓存</h6><p>向服务器发送请求，服务器会根据这个请求的请求头中的一些参数来判断是否命中协商缓存，如果命中，则返回304状态码并带上新的响应头通知浏览器从缓存中读取资源；  </p>
<p>Last-Modified/If-Modified-Since和Etag/If-None-Match是分别成对出现的，呈一一对应关系  </p>
<p><strong>Etag(响应头返回)/If-None-Match(请求头发送)：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Etag：Etag是属于HTTP 1.1属性，它是由服务器（Apache或者其他工具）生成返回给前端，用来帮助服务器控制Web端的缓存验证。  </span><br><span class="line">If-None-Match: 当资源过期时，浏览器发现响应头里有Etag,则再次向服务器请求时带上请求头if-none-match(值是Etag的值)。服务器收到请求进行比对，决定返回200或304</span><br></pre></td></tr></table></figure></p>
<p><img src="https://user-gold-cdn.xitu.io/2019/5/6/16a8c60fb0ef49f0?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="image"></p>
<p><strong>Last-Modified(响应头返回)/If-Modified-Since(请求头发送)：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Last-Modified：浏览器向服务器发送资源最后的修改时间  </span><br><span class="line">If-Modified-Since：当资源过期时（浏览器判断Cache-Control标识的max-age过期），发现响应头具有Last-Modified声明，则再次向服务器请求时带上头if-modified-since，表示请求时间。服务器收到请求后发现有if-modified-since则与被请求资源的最后修改时间进行对比（Last-Modified）,若最后修改时间较新（大），说明资源又被改过，则返回最新资源，HTTP 200 OK;若最后修改时间较旧（小），说明资源无新修改，响应HTTP 304 走缓存。</span><br></pre></td></tr></table></figure></p>
<p>Etag优先级是高于Last-Modified，所以服务器会优先验证Etag<br>Last-Modified/If-Modified-Since是http1.0的头字段</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">HJP</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">137</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">23</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">HJP</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
